# 音を紡ぐゲーム - OtoTsumu

異世界転生をテーマにした、音を組み合わせてメロディーを作るゲームです。

## ゲームの概要

異世界に転生したプレイヤーは、音程猫とリズム猫が住む村で、カードを組み合わせてメロディーを紡いでいきます。
音の贈り物を作ります。
ゲーム後にWavファイルで出力ができます。

### 物語

- **第1章：はじめてのメロディー**
  - 音程猫とリズム猫と出会い、カードを組み合わせてメロディーを作ることを学びます
  - 16小節のメロディーを完成させ、目標スコアを達成するとクリア

- **第2章：森の賢王**
  - 森の賢王が現れ、さらなる高みを目指すメロディーを求めます
  - より高い目標スコアを達成する必要があります

- **第3章：お祭りのメロディー**
  - 満足した森の賢王とともに、お祭りのメロディーを作ります
  - 最終章をクリアするとハッピーエンド

## ゲームの遊び方

### 基本操作

1. **カードの配置**
   - リズム猫のカードと音程猫のカードをピアノロールにドロップします
   - 同じ位置にリズムカードと音程カードを重ねると、自動的に組み合わされます

2. **小節の完成**
   - 小節が完全に埋まると、カードが確定状態になります
   - 確定されたカードの音が流れ、スコアが獲得できます

3. **連鎖システム**
   - 小節が完全でない状態でカードを配置すると、待機状態になります
   - 次のカードを連結すると、前のカードにずれて配置され、小節が完成すると確定されます

4. **クリア条件**
   - 16小節分のメロディーを完成させ、目標スコアを達成すると章をクリアできます

### カードの種類

- **リズムカード**
  - 音符の長さを表すカード（例：884、448）
  - 8分音符を基準とした長さの組み合わせ

- **音程カード**
  - 音の高さを表すカード（例：C4 E4 G4、A3 A4 C4）
  - 同じ音を繰り返す、上行形、下行形、ランダムなど様々なパターンがあります

## 技術仕様

- HTML5 Canvas によるピアノロール表示
- Web Audio API による音の再生
- ドラッグ&ドロップによる直感的な操作
- レスポンシブデザイン対応

## ファイル構成

- `index.html` - メインHTMLファイル
- `styles.css` - スタイルシート
- `game.js` - メインゲームロジック
- `card.js` - カードクラスとカード生成
- `staff.js` - 五線紙クラス
- `audioManager.js` - 音の管理
- `story.js` - ストーリー管理

## 実行方法

1. ファイルをダウンロードまたはクローン
2. `index.html` をブラウザで開く
3. ゲームを開始！

## 今後の改善予定

- より多様なカードパターン
- アニメーション効果
- セーブ/ロード機能
- より高度な音の合成

